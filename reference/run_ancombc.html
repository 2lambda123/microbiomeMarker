<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Differential analysis of compositions of microbiomes with bias correction
(ANCOM-BC). — run_ancombc • microbiomeMarker</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Differential analysis of compositions of microbiomes with bias correction
(ANCOM-BC). — run_ancombc" />
<meta property="og:description" content="Differential abundance analysis for microbial absolute abundance data. This
function is a wrapper of ANCOMBC::ancombc()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microbiomeMarker</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/microbiomeMarker-vignette.html">Tools for microbiome marker identification</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/yiluheihei/microbiomeMarker/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Differential analysis of compositions of microbiomes with bias correction
(ANCOM-BC).</h1>
    <small class="dont-index">Source: <a href='https://github.com/yiluheihei/microbiomeMarker/blob/master/R/DA-ancombc.R'><code>R/DA-ancombc.R</code></a></small>
    <div class="hidden name"><code>run_ancombc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Differential abundance analysis for microbial absolute abundance data. This
function is a wrapper of <code><a href='https://rdrr.io/pkg/ANCOMBC/man/ancombc.html'>ANCOMBC::ancombc()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>run_ancombc</span><span class='op'>(</span>
  <span class='va'>ps</span>,
  <span class='va'>group</span>,
  <span class='va'>formula</span>,
  contrast <span class='op'>=</span> <span class='cn'>NULL</span>,
  taxa_rank <span class='op'>=</span> <span class='st'>"all"</span>,
  transform <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"identity"</span>, <span class='st'>"log10"</span>, <span class='st'>"log10p"</span><span class='op'>)</span>,
  norm <span class='op'>=</span> <span class='st'>"none"</span>,
  norm_para <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  p_adjust <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"fdr"</span>, <span class='st'>"bonferroni"</span>, <span class='st'>"holm"</span>, <span class='st'>"hochberg"</span>, <span class='st'>"hommel"</span>, <span class='st'>"BH"</span>, <span class='st'>"BY"</span><span class='op'>)</span>,
  zero_cut <span class='op'>=</span> <span class='fl'>0.9</span>,
  lib_cut <span class='op'>=</span> <span class='fl'>0</span>,
  struc_zero <span class='op'>=</span> <span class='cn'>FALSE</span>,
  neg_lb <span class='op'>=</span> <span class='cn'>FALSE</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-05</span>,
  max_iter <span class='op'>=</span> <span class='fl'>100</span>,
  conserve <span class='op'>=</span> <span class='cn'>FALSE</span>,
  pvalue_cutoff <span class='op'>=</span> <span class='fl'>0.05</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ps</th>
      <td><p>a <code><a href='https://rdrr.io/pkg/phyloseq/man/phyloseq-class.html'>phyloseq::phyloseq</a></code> object, which consists of a feature
table, a sample metadata and a taxonomy table.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>the name of the group variable in metadata. Specifying
<code>group</code> is required for detecting structural zeros and performing
global test.</p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>the character string expresses how the microbial absolute
abundances for each taxon depend on the variables in metadata.</p></td>
    </tr>
    <tr>
      <th>contrast</th>
      <td><p>this parameter only used for two groups comparison while
there are multiple groups. For more please see the following details.</p></td>
    </tr>
    <tr>
      <th>taxa_rank</th>
      <td><p>character to specify taxonomic rank to perform
differential analysis on. Should be one of
<code><a href='https://rdrr.io/pkg/phyloseq/man/rank_names.html'>phyloseq::rank_names(phyloseq)</a></code>, or "all" means to summarize the taxa by
the top taxa ranks (<code><a href='summarize_taxa.html'>summarize_taxa(ps, level = rank_names(ps)[1])</a></code>), or
"none" means perform differential analysis on the original taxa
(<code><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names(phyloseq)</a></code>, e.g., OTU or ASV).</p></td>
    </tr>
    <tr>
      <th>transform</th>
      <td><p>character, the methods used to transform the microbial
abundance. See <code><a href='transform_abundances.html'>transform_abundances()</a></code> for more details. The
options include:</p><ul>
<li><p>"identity", return the original data without any transformation
(default).</p></li>
<li><p>"log10", the transformation is <code><a href='https://rdrr.io/r/base/Log.html'>log10(object)</a></code>, and if the data contains
zeros the transformation is <code><a href='https://rdrr.io/r/base/Log.html'>log10(1 + object)</a></code>.</p></li>
<li><p>"log10p", the transformation is <code><a href='https://rdrr.io/r/base/Log.html'>log10(1 + object)</a></code>.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>norm</th>
      <td><p>the methods used to normalize the microbial abundance data. See
<code><a href='normalize,phyloseq-method.html'>normalize()</a></code> for more details.
Options include:</p><ul>
<li><p>"none": do not normalize.</p></li>
<li><p>"rarefy": random subsampling counts to the smallest library size in the
data set.</p></li>
<li><p>"TSS": total sum scaling, also referred to as "relative abundance", the
abundances were normalized by dividing the corresponding sample library
size.</p></li>
<li><p>"TMM": trimmed mean of m-values. First, a sample is chosen as reference.
The scaling factor is then derived using a weighted trimmed mean over the
differences of the log-transformed gene-count fold-change between the
sample and the reference.</p></li>
<li><p>"RLE", relative log expression, RLE uses a pseudo-reference calculated
using the geometric mean of the gene-specific abundances over all
samples. The scaling factors are then calculated as the median of the
gene counts ratios between the samples and the reference.</p></li>
<li><p>"CSS": cumulative sum scaling, calculates scaling factors as the
cumulative sum of gene abundances up to a data-derived threshold.</p></li>
<li><p>"CLR": centered log-ratio normalization.</p></li>
<li><p>"CPM": pre-sample normalization of the sum of the values to 1e+06.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>norm_para</th>
      <td><p>named <code>list</code>. other arguments passed to specific
normalization methods.  Most users will not need to pass any additional
arguments here.</p></td>
    </tr>
    <tr>
      <th>p_adjust</th>
      <td><p>method to adjust p-values by. Default is "holm".
Options include "holm", "hochberg", "hommel", "bonferroni", "BH", "BY",
"fdr", "none". See <code><a href='https://rdrr.io/r/stats/p.adjust.html'>stats::p.adjust()</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>zero_cut</th>
      <td><p>a numerical fraction between 0 and 1. Taxa with proportion of
zeroes greater than <code>zero_cut</code> will be excluded in the analysis. Default
is 0.90.</p></td>
    </tr>
    <tr>
      <th>lib_cut</th>
      <td><p>a numerical threshold for filtering samples based on library
sizes. Samples with library sizes less than <code>lib_cut</code> will be excluded
in the analysis. Default is 0, i.e. do not filter any sample.</p></td>
    </tr>
    <tr>
      <th>struc_zero</th>
      <td><p>whether to detect structural zeros. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>neg_lb</th>
      <td><p>whether to classify a taxon as a structural zero in the
corresponding study group using its asymptotic lower bound.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>the iteration convergence tolerance for the E-M algorithm.
Default is 1e-05.</p></td>
    </tr>
    <tr>
      <th>max_iter</th>
      <td><p>the maximum number of iterations for the E-M algorithm.
Default is 100.</p></td>
    </tr>
    <tr>
      <th>conserve</th>
      <td><p>whether to use a conservative variance estimate of
the test statistic. It is recommended if the sample size is small and/or
the number of differentially abundant taxa is believed to be large.
Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>pvalue_cutoff</th>
      <td><p>level of significance. Default is 0.05.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code><a href='microbiomeMarker-class.html'>microbiomeMarker</a></code> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>contrast</code> must be a two length character or <code>NULL</code> (default). It is only
required to set manually for two groups comparison when there are multiple
groups. The order determines the direction of comparison, the first element
is used to specify the reference group (control). This means that, the first
element is the denominator for the fold change, and the second element is
used as baseline (numerator for fold change). Otherwise, users do required
to concern this parameter (set as default <code>NULL</code>), and if there are
two groups, the first level of groups will set as the reference group; if
there are multiple groups, it will perform an ANOVA-like testing to find
markers which difference in any of the groups.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Lin, Huang, and Shyamal Das Peddada. "Analysis of compositions of microbiomes
with bias correction." Nature communications 11.1 (2020): 1-11.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/ANCOMBC/man/ancombc.html'>ANCOMBC::ancombc</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>enterotypes_arumugam</span><span class='op'>)</span>
<span class='va'>ps</span> <span class='op'>&lt;-</span> <span class='fu'>phyloseq</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/subset_samples-methods.html'>subset_samples</a></span><span class='op'>(</span>
    <span class='va'>enterotypes_arumugam</span>,
    <span class='va'>Enterotype</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Enterotype 3"</span>, <span class='st'>"Enterotype 2"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'>run_ancombc</span><span class='op'>(</span><span class='va'>ps</span>, group <span class='op'>=</span> <span class='st'>"Enterotype"</span>, formula <span class='op'>=</span> <span class='st'>"Enterotype"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The multi-group comparison will be deactivated as the group variable has &lt; 3 categories</span></div><div class='output co'>#&gt; <span class='warning'>Warning: return the original feature table.</span></div><div class='output co'>#&gt; microbiomeMarker-class inherited from phyloseq-class
#&gt; normalization method:              [ none ]
#&gt; microbiome marker identity method: [ ancombc ]
#&gt; marker_table() Marker Table:       [ 26 microbiome markers with 5 variables ]
#&gt; otu_table()    OTU Table:          [ 235 taxa and  24 samples ]
#&gt; sample_data()  Sample Data:        [ 24 samples by  9 sample variables ]
#&gt; tax_table()    Taxonomy Table:     [ 235 taxa by 1 taxonomic ranks ]</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Yang Cao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


